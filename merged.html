<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <title>Memory Card Game</title>
</head>
<style>
    body {
        background-image: linear-gradient(to right, rgb(167, 208, 230), rgb(57, 106, 141)); 
    }

    img {
        width: 100px;
        height: 100px;
        border-radius: 5px;
    }

    #header {
        text-align: center;
        font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }

    #mainDiv {
        display: flex;
        justify-content: space-evenly;
    }

    #imagesDiv {
        display: grid;
        grid-template-columns: 105px 105px 105px 105px;
        gap: 5px;
        justify-content: center;        
        padding: 20px;
        box-shadow: 8px 9px 5px 0px rgba(20, 23, 25, 0.08);
        -webkit-box-shadow: 8px 9px 5px 0px rgba(20, 23, 25, 0.08);
        -moz-box-shadow: 8px 9px 5px 0px rgba(20, 23, 25, 0.08);
    }

    #myDiv {
        display: flow-root;
        font-size: 30px;
        width: 25%;
        gap: 10px;
        padding: 10px;
        margin-left: 25%;
        margin-top: 20%;
    }

    .time {
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #FFFFFF99;
        border-radius: 10px;
    }

    .hide {
        display: none;
        background-color: black;
        color: aliceblue;
        border-radius: 10px;
        width: 100%;
        font-size: 15px;
        height: 25px;
    }

    .btn {
        background-color: black;
        color: aliceblue;
        border-radius: 10px;
        width: 100%;
        font-size: 15px;
        height: 25px;
    }

    .show {
        background-color: black;
        color: aliceblue;
        border-radius: 10px;
        width: 100%;
        font-size: 15px;
        height: 25px;
    }

    #container {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
    }

    svg {
        position: absolute;
        z-index: -1;;
    }
</style>

<script>
    let imagesObjs = [{id:1, img:"images/1.png"},
                        {id:2, img:"images/6.png"},
                        {id:3, img:"images/3.png"},
                        {id:4, img:"images/2.png"},
                        {id:5, img:"images/4.png"},
                        {id:6, img:"images/5.png"},
                        {id:7, img:"images/8.png"},
                        {id:8, img:"images/1.png"},
                        {id:9, img:"images/5.png"},
                        {id:10, img:"images/3.png"},
                        {id:11, img:"images/6.png"},
                        {id:12, img:"images/4.png"},
                        {id:13, img:"images/7.png"},
                        {id:14, img:"images/2.png"},
                        {id:15, img:"images/8.png"},
                        {id:16, img:"images/7.png"}];

    let dotsArray = [{id:"svg1", color:'red'},
                        {id:"svg2", color:'blue'},
                        {id:"svg3", color:'yellow'},
                        {id:"svg4", color:'orange'},
                        {id:"svg5", color:'green'},
                        {id:"svg6", color:'darkgreen'},
                        {id:"svg7", color:'grey'},
                        {id:"svg8", color:'white'},
                        {id:"svg9", color:'black'},
                        {id:"svg10", color:'pink'},
                        {id:"svg11", color:'red'},
                        {id:"svg12", color:'yellow'},
                        {id:"svg13", color:'orange'},
                        {id:"svg14", color:'green'},
                        {id:"svg15", color:'blue'}];

    let count = 0;
    let clickedImagesArray = [];
    let questionMarkImage = "images/temp.png";

	let total = 5;
	let minute = 0;
	let seconds = 59;

	let intId = setInterval(timer, 1000);

	function setup() {
		let minuteDiv = $('#myMin');
		let secondsDiv = $('#mySec');
		let html = '';
		if (total < 10) {
			html = '<label>0' + total + '</label>';
		} else {
			html = '<label>' + total + '</label>';
		}
		minuteDiv.empty();
		secondsDiv.empty();
		minuteDiv.append(html);
		html = '<label>00</label>';
		secondsDiv.append(html);
		minute = total - 1;
	}

	function timer() {
		let minuteDiv = $('#myMin');
		let secondsDiv = $('#mySec');
		let result = $('#result');
		let html = '';
		if (seconds >= 0) {
			minuteDiv.empty();
			secondsDiv.empty();
			if (minute < 10) {
				html = '<label>0' + minute + '</label>';
			} else {
				html = '<label>' + minute + '</label>';
			}
			minuteDiv.append(html);
			if (seconds < 10) {
				html = '<label>0' + seconds + '</label>';
			} else {
				html = '<label>' + seconds + '</label>';
			}
			secondsDiv.append(html);
			seconds--;

		} else {
			if (minute > 0) {
				minute--;
				if (minute < 10) {
					html = '<label>0' + minute + '</label>';
				} else {
					html = '<label>' + minute + '</label>';
				}
				minuteDiv.append(html);
				minuteDiv.html(html);
				seconds = 59;
				html = '<label>' + seconds + '</label>';
				secondsDiv.html(html);
			} else {
				result.append('<label>Finished!</label>');
				clearInterval(intId);
			}

		}
	}
	function pause() {
		let resume = $('#resume');
		let pause = $('#pause');
		clearInterval(intId);
		resume.addClass('show');
		resume.removeClass('hide');
		pause.addClass('hide');
	}
	function resume() {
		let resume = $('#resume');
		let pause = $('#pause');
		intId = setInterval(timer, 1000);
		pause.addClass('show');
		pause.removeClass('hide');
		resume.addClass('hide');
	}
	function restart() {
		setup();
		seconds = 59;
		clearInterval(intId);
		resume();
    }

    function changePosition(id, color) {
        let mysvg = $("#" + id);
        //random numbers
        random = {
            a: Math.floor(Math.random()*800),
            b: Math.floor(Math.random()*800)
        };

        let html = '<svg id="' + id + '" style="width:300; height:300; position:absolute; top:' + random.a +
        'px; left:' + random.b + 'px"><circle style="cx:50; cy:50; r:10; fill:' + color + '" /></svg>';
        let newSvg = $(html);

        mysvg.replaceWith(newSvg);
    }

    $('document').ready(function () {
		setup();
		
        $("#imagesDiv").html('');

        // for (let i=0; i<imagesObjs.length; i++) {
        //     let newObj = $('<img src="' + imagesObjs[i].img + '" onclick="showImage(this, ' + (i+1) + ')" />');
        //     $("#imagesDiv").append(newObj);
        // }

        for (let i=0; i<imagesObjs.length; i++) {
            let newObj = $('<img src="' + questionMarkImage + '" onclick="showImage(this, ' + (i+1) + ')" />');
            $("#imagesDiv").append(newObj);
        }

        for (let dot of dotsArray) {
            let html = '<svg id="' + dot.id + '" style="width:300; height:300; position:absolute; ' +
            'top:50px; left:50px"><circle style="cx:50; cy:50; r:10; fill:' + dot.color + '" /></svg>';

            let newSVG = $(html);

            $("body").append(newSVG);
        }

        for (let dot of dotsArray) {
            setInterval(function() {
                changePosition(dot.id, dot.color);
            }, 1000);
        }
    })

    function replaceImages() {
        for (let obj of clickedImagesArray) {
            setTimeout(() => {
                let htmlId = "#" + obj.id;
                let qImage = $('<img src="' + questionMarkImage + '" onclick="showImage(this, ' + obj.id + ')" />');
                $(htmlId).replaceWith(qImage);

            }, 1000);
        }
    }

    function showImage(self, id) {
        if (clickedImagesArray.length == 2) {
            // do nothing
        }
        else {
            let clickedImage = imagesObjs.filter((v, i, array) => v.id == id)[0];
            let html = '<img id="' + id + '" src="' + clickedImage.img + '" />';
            let imageHtml = $(html);
            $(self).replaceWith(imageHtml);

            clickedImagesArray.push(clickedImage);

            if (clickedImagesArray.length == 2) {
                if (!(clickedImagesArray[0].img == clickedImagesArray[1].img)) {
                    replaceImages();
                }
                else {
                    count++;
                }

                clickedImagesArray = [];
            }
        }
    }
</script>

<body>
    <div id="container">
        <div id="myDiv">
            <div class="time">
                <div id="myMin"></div>:
                <div id="mySec"></div>
            </div>
            <div><button onclick="restart()" id="restart" class="btn">Restart</button>
                <button onclick="pause()" id="pause" class="btn">Pause</button>
                <button onclick="resume()" id="resume" class="hide">Resume</button>
            </div>
        </div>
        <div id = "result"></div>
	</div>
	
    <h1 id="header">Memory Card Game</h1>
    <div id="mainDiv">
        <div></div>
        <div id="imagesDiv"></div>
        <div></div>
    </div>

</body>

</html>